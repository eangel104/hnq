<!DOCTYPE html>
<html lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width">
<title>한화 Home &amp; Q</title>
<link rel="stylesheet" type="text/css" href="../css/common.css">
<link rel="stylesheet" type="text/css" href="../css/content.css">
<link rel="stylesheet" type="text/css" href="../css/content2.css">
</head>
<body>

<!-- login -->
<div class="login">

    <div class="login_section">
        <h1 class="logo">Home &amp; Q</h1>
        <p class="desc">아이디와 비밀번호를 입력해주세요</p>
        <ul class="login_input">
            <li class="login_id">
                <input type="text" id="login_id"/>
            </li>
            <li class="login_pw">
                <input type="password" id="login_pw"/>
            </li>
        </ul>
        <label class="id_save"><input type="checkbox" id="chk_id_save"><span class="label_txt">Save ID</span></label>
        <a href="#n" class="btn_login" id='btn_login'>LOGIN</a>
    </div>
    <p class="app_msg" id="app_msg">앱 설치 및 사용문의(고객센터 전화번호 <span id="tel">1111-1111</span>)</p>
    <!-- TODO: 디버그 단추. 배포 전 반드시 지우기 --><button id="btn_debug_popup" class="btn middle orange">Reset POPUP</button><!-- TODO: 디버그 단추. 배포 전 반드시 지우기 -->
    <!-- 약관동의 팝업 -->
    <div class="layer_wrap large" >
        <div class="layer_popup" id="agreepopup">
            <div class="popup_form">
                <div class="header">
                    <h3 class="page_title">약관동의</h3>
                    <a href="#n" class="page_close" onclick="popupClose(this);">이전페이지</a>
                </div>
                <div class="popup_list">
                    <p class="tit_type02 mt0">
                        아래의 약관에 대한 내용을 반드시 읽고 약관에 동의 하셔야 모바일 시공관리 앱을 이용 가능 합니다.
                    </p>
                    <div class="all_check mt10">
                        <label class="chk_style">
                            <input type="checkbox" name="rdo_chk01">
                            <span class="chk_txt">이용약관</span>
                        </label>
                        <div class="agree_form">제 1 조 (목적) 
                            제 1 조 (목적) 
                            본 서비스 이용 약관은 한화엘앤씨㈜(이하 ”회사”)가 운영하는 모바일 영업지원 프로그램(이하 “앱”)을 이용 함에 있어 회사와 이용자(이하 “사용자”)의 권리, 의무 및 책임사항, 기타 필요한 사항을 규정함을 목적으로 합니다. 
                            .v
                            제 2 조 (정의) 
                            이 약관에서 사용하는 용어의 정의는 다음과 같습니다.
                            ① "서비스"라 함은 구현되는 단말기(PC, TV, 휴대형 단말기 등의 각종 유무선 장치를 포함)와 상관없이 "사용자"가 이용할 수 있는 앱 관련 제반 서비스를 의미
                            합니다.
                            ② "사용자"라 함은 "서비스"에 접속하여 이 약관에 따라 "회사"와 이용 계약을 체결하고 "회사"가 제공 하는 "서비스"를 이용하는 자를 말합니다. 
                            
                            제 3 조 (약관의 게시와 개정) 
                            ① "회사"는 이 약관의 내용을 "사용자"가 쉽게 알 수
                            있도록 서비스 설정 화면에 게시합니다. 
                            ② "회사"는 "약관의 규제에 관한 법률", "정보 통신망 이용촉진 및 정보보호 등에 관한 법률”, “위치정보의 보호 및 이용 등에 관한 법률” (이하 “관계 법령”)등을 
                            위배하지 않는 범위에서 이 약관을 개정할 수 있습니다. 
                            ③  "회사"가 약관을 개정할 경우에는 적용일자 및 개정사유를 명시하여 현행약관과 함께 제1항의 방식에 따라 그 개정약관의 적용일자 30일 전부터 적용일자 전일까지 공지합니다. 또한 로그인시 동의창 등의 전자적 수단을 통해 따로 개정된 약관을 명확히 통지하도록 합니다.
                            ④ 회사가 전항에 따라 개정약관을 공지 또는 통지하면서 사용자에게 30일 기간 내에 의사표시를 하지 않으면 의사표시가 표명된 것으로 본다는 뜻을 명확하게 공지 또는 통지하였음에도 사용자가 명시적으로 거부의 의사표시를 하지 아니한 경우 사용자가 개정약관에 동의한 것으로 봅니다.
                            ⑤ 사용자가 개정약관의 적용에 동의하지 않는 경우 회사는 개정 약관의 내용을 적용할 수 없으며, 이 경우 사용자는 이용계약을 해지할 수 있습니다. 다만, 기존 약관을 적용할 수 없는 특별한 사정이 있는 경우에는 회사는 이용계약을 해지할 수 있습니다.
                            
                            제 4 조 (이용계약 체결) 
                            ① 이용 계약은 사용신청자가 약관의 내용에 대하여 동의를 한 다음 앱 사용 신청을 하고 "회사"가 이러한 신청에 대하여 승인함으로써 체결됩니다. 
                            ② "회사"는 사용신청자의 “서비스” 사용 신청에 대하여 "서비스" 이용을 승낙함을 원칙으로 합니다. 다만, "회사"는 다음 각 호에 해당하는 신청에 대하여는 승낙을 하지 않거나 사후에 이용계약을 해지할 수 있습니다. 
                            1. 사용 신청자가 이 약관에 의하여 이전에 사용자자격을 상실한 적이 있는 경우, 단 "회사"의 사용자 재가입 승낙을 얻은 경우에는 예외로 함. 
                            2. 실명이 아니거나 타인의 명의를 이용한 경우 
                            3. 허위의 정보를 기재하거나, "회사"가 제시하는 내용을 기재하지 않은 경우 
                            4. 이용자의 귀책사유로 인하여 승인이 불가능하거나 기타 규정한 제반 사항을 위반하며 신청하는 경우 
                            5. 회사가 판단하는 “서비스” 대상자가 아닌 경우
                            ③ 제1항에 따른 신청에 있어 "회사"는 "사용자"의 종류에 따라 전문기관을 통한 실명확인 및 본인인증을 요청할 수 있습니다. 
                            ④  "회사"는 서비스관련설비의 여유가 없거나, 기술상 또는 업무상 문제가 있는 경우 “서비스” 사용신청 승낙을 유보할 수 있습니다. 
                            ⑤  제2항과 제4항에 따라 사용자가입신청의 승낙을 하지 아니하거나 유보한 경우, "회사"는 원칙적으로 이를 가입신청자에게 알리도록 합니다. 
                            ⑥  이용계약의 성립 시기는 "회사"가 가입완료를 신청절차 상에서 표시한 시점으로 합니다. 
                            
                            제 5 조 (사용자정보의 변경) 
                            ①  "사용자"은 개인정보관리화면을 통하여 언제든지 본인의 개인정보를 열람하고 수정할 수 있습니다. 다만, 서비스 관리를 위해 필요한 항목 (예 : 실명, 소속정보) 등은 수정이 불가능합니다. 
                            ②  "사용자"은 사용자 가입신청 시 기재한 사항이 변경되었을 경우 온라인으로 수정을 하거나 전자우편 기타 방법으로 "회사"에 대하여 그 변경사항을 알려야 합니다. 
                            ③  제2항의 변경사항을 "회사"에 알리지 않아 발생한 불이익에 대하여 "회사"는 책임지지 않습니다. 
                        </div>
                    </div>
                    <div class="all_check mt10">
                        <label class="chk_style">
                            <input type="checkbox" name="rdo_chk01">
                            <span class="chk_txt">개인정보취급방침</span>
                        </label>
                        <div class="agree_form">제 1 조 (목적) 
                            본 서비스 이용 약관은 한화엘앤씨㈜(이하 ”회사”)가 운영하는 모바일 영업지원 프로그램(이하 “앱”)을 이용 함에 있어 회사와 이용자(이하 “사용자”)의 권리, 의무 및 책임사항, 기타 필요한 사항을 규정함을 목적으로 합니다. 
                            .v
                            제 2 조 (정의) 
                            이 약관에서 사용하는 용어의 정의는 다음과 같습니다.
                            ① "서비스"라 함은 구현되는 단말기(PC, TV, 휴대형 단말기 등의 각종 유무선 장치를 포함)와 상관없이 "사용자"가 이용할 수 있는 앱 관련 제반 서비스를 의미
                            합니다.
                            ② "사용자"라 함은 "서비스"에 접속하여 이 약관에 따라 "회사"와 이용 계약을 체결하고 "회사"가 제공 하는 "서비스"를 이용하는 자를 말합니다. 
                            
                            제 3 조 (약관의 게시와 개정) 
                            ① "회사"는 이 약관의 내용을 "사용자"가 쉽게 알 수
                            있도록 서비스 설정 화면에 게시합니다. 
                            ② "회사"는 "약관의 규제에 관한 법률", "정보 통신망 이용촉진 및 정보보호 등에 관한 법률”, “위치정보의 보호 및 이용 등에 관한 법률” (이하 “관계 법령”)등을 
                            위배하지 않는 범위에서 이 약관을 개정할 수 있습니다. 
                            ③  "회사"가 약관을 개정할 경우에는 적용일자 및 개정사유를 명시하여 현행약관과 함께 제1항의 방식에 따라 그 개정약관의 적용일자 30일 전부터 적용일자 전일까지 공지합니다. 또한 로그인시 동의창 등의 전자적 수단을 통해 따로 개정된 약관을 명확히 통지하도록 합니다.
                            ④ 회사가 전항에 따라 개정약관을 공지 또는 통지하면서 사용자에게 30일 기간 내에 의사표시를 하지 않으면 의사표시가 표명된 것으로 본다는 뜻을 명확하게 공지 또는 통지하였음에도 사용자가 명시적으로 거부의 의사표시를 하지 아니한 경우 사용자가 개정약관에 동의한 것으로 봅니다.
                            ⑤ 사용자가 개정약관의 적용에 동의하지 않는 경우 회사는 개정 약관의 내용을 적용할 수 없으며, 이 경우 사용자는 이용계약을 해지할 수 있습니다. 다만, 기존 약관을 적용할 수 없는 특별한 사정이 있는 경우에는 회사는 이용계약을 해지할 수 있습니다.
                            
                            제 4 조 (이용계약 체결) 
                            ① 이용 계약은 사용신청자가 약관의 내용에 대하여 동의를 한 다음 앱 사용 신청을 하고 "회사"가 이러한 신청에 대하여 승인함으로써 체결됩니다. 
                            ② "회사"는 사용신청자의 “서비스” 사용 신청에 대하여 "서비스" 이용을 승낙함을 원칙으로 합니다. 다만, "회사"는 다음 각 호에 해당하는 신청에 대하여는 승낙을 하지 않거나 사후에 이용계약을 해지할 수 있습니다. 
                            1. 사용 신청자가 이 약관에 의하여 이전에 사용자자격을 상실한 적이 있는 경우, 단 "회사"의 사용자 재가입 승낙을 얻은 경우에는 예외로 함. 
                            2. 실명이 아니거나 타인의 명의를 이용한 경우 
                            3. 허위의 정보를 기재하거나, "회사"가 제시하는 내용을 기재하지 않은 경우 
                            4. 이용자의 귀책사유로 인하여 승인이 불가능하거나 기타 규정한 제반 사항을 위반하며 신청하는 경우 
                            5. 회사가 판단하는 “서비스” 대상자가 아닌 경우
                            ③ 제1항에 따른 신청에 있어 "회사"는 "사용자"의 종류에 따라 전문기관을 통한 실명확인 및 본인인증을 요청할 수 있습니다. 
                            ④  "회사"는 서비스관련설비의 여유가 없거나, 기술상 또는 업무상 문제가 있는 경우 “서비스” 사용신청 승낙을 유보할 수 있습니다. 
                            ⑤  제2항과 제4항에 따라 사용자가입신청의 승낙을 하지 아니하거나 유보한 경우, "회사"는 원칙적으로 이를 가입신청자에게 알리도록 합니다. 
                            ⑥  이용계약의 성립 시기는 "회사"가 가입완료를 신청절차 상에서 표시한 시점으로 합니다. 
                        </div>
                    </div>
                    <div class="all_check mt10">
                        <label class="chk_style">
                            <input type="checkbox" name="rdo_chk01">
                            <span class="chk_txt">위치정보 이용</span>
                        </label>
                        <div class="agree_form">제 1 조 (목적) 
                            본 서비스 이용 약관은 한화엘앤씨㈜(이하 ”회사”)가 운영하는 모바일 영업지원 프로그램(이하 “앱”)을 이용 함에 있어 회사와 이용자(이하 “사용자”)의 권리, 의무 및 책임사항, 기타 필요한 사항을 규정함을 목적으로 합니다. 
                            .v
                            제 2 조 (정의) 
                            이 약관에서 사용하는 용어의 정의는 다음과 같습니다.
                            ① "서비스"라 함은 구현되는 단말기(PC, TV, 휴대형 단말기 등의 각종 유무선 장치를 포함)와 상관없이 "사용자"가 이용할 수 있는 앱 관련 제반 서비스를 의미
                            합니다.
                            ② "사용자"라 함은 "서비스"에 접속하여 이 약관에 따라 "회사"와 이용 계약을 체결하고 "회사"가 제공 하는 "서비스"를 이용하는 자를 말합니다. 
                            
                            제 3 조 (약관의 게시와 개정) 
                            ① "회사"는 이 약관의 내용을 "사용자"가 쉽게 알 수
                            있도록 서비스 설정 화면에 게시합니다. 
                            ② "회사"는 "약관의 규제에 관한 법률", "정보 통신망 이용촉진 및 정보보호 등에 관한 법률”, “위치정보의 보호 및 이용 등에 관한 법률” (이하 “관계 법령”)등을 
                            위배하지 않는 범위에서 이 약관을 개정할 수 있습니다. 
                            ③  "회사"가 약관을 개정할 경우에는 적용일자 및 개정사유를 명시하여 현행약관과 함께 제1항의 방식에 따라 그 개정약관의 적용일자 30일 전부터 적용일자 전일까지 공지합니다. 또한 로그인시 동의창 등의 전자적 수단을 통해 따로 개정된 약관을 명확히 통지하도록 합니다.
                            ④ 회사가 전항에 따라 개정약관을 공지 또는 통지하면서 사용자에게 30일 기간 내에 의사표시를 하지 않으면 의사표시가 표명된 것으로 본다는 뜻을 명확하게 공지 또는 통지하였음에도 사용자가 명시적으로 거부의 의사표시를 하지 아니한 경우 사용자가 개정약관에 동의한 것으로 봅니다.
                            ⑤ 사용자가 개정약관의 적용에 동의하지 않는 경우 회사는 개정 약관의 내용을 적용할 수 없으며, 이 경우 사용자는 이용계약을 해지할 수 있습니다. 다만, 기존 약관을 적용할 수 없는 특별한 사정이 있는 경우에는 회사는 이용계약을 해지할 수 있습니다.
                            
                            제 4 조 (이용계약 체결) 
                            ① 이용 계약은 사용신청자가 약관의 내용에 대하여 동의를 한 다음 앱 사용 신청을 하고 "회사"가 이러한 신청에 대하여 승인함으로써 체결됩니다. 
                            ② "회사"는 사용신청자의 “서비스” 사용 신청에 대하여 "서비스" 이용을 승낙함을 원칙으로 합니다. 다만, "회사"는 다음 각 호에 해당하는 신청에 대하여는 승낙을 하지 않거나 사후에 이용계약을 해지할 수 있습니다. 
                            1. 사용 신청자가 이 약관에 의하여 이전에 사용자자격을 상실한 적이 있는 경우, 단 "회사"의 사용자 재가입 승낙을 얻은 경우에는 예외로 함. 
                            2. 실명이 아니거나 타인의 명의를 이용한 경우 
                            3. 허위의 정보를 기재하거나, "회사"가 제시하는 내용을 기재하지 않은 경우 
                            4. 이용자의 귀책사유로 인하여 승인이 불가능하거나 기타 규정한 제반 사항을 위반하며 신청하는 경우 
                            5. 회사가 판단하는 “서비스” 대상자가 아닌 경우
                            ③ 제1항에 따른 신청에 있어 "회사"는 "사용자"의 종류에 따라 전문기관을 통한 실명확인 및 본인인증을 요청할 수 있습니다. 
                            ④  "회사"는 서비스관련설비의 여유가 없거나, 기술상 또는 업무상 문제가 있는 경우 “서비스” 사용신청 승낙을 유보할 수 있습니다. 
                            ⑤  제2항과 제4항에 따라 사용자가입신청의 승낙을 하지 아니하거나 유보한 경우, "회사"는 원칙적으로 이를 가입신청자에게 알리도록 합니다. 
                            ⑥  이용계약의 성립 시기는 "회사"가 가입완료를 신청절차 상에서 표시한 시점으로 합니다. 
                        </div>
                    </div>
                    <div class="tac mt10">
                        <a href="#n" class="btn middle" id="btn_confirm">동의</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- //약관동의 팝업 -->
</div>
<!-- //login -->
<script type="text/javascript" src="../js/mcore.min.js"></script>
<script type="text/javascript" src="../js/jquery.bxslider.min.js"></script>
<script type="text/javascript" src="../js/common.js"></script>
<!-- //login -->
<script type="text/javascript">
    //TODO: 개발 미비
    "use strict";

    // 영속 및 전역 변수
    var GLOBAL_USER_TYPE = "GLOBAL_USER_TYPE";
    var STORAGE_USER_ID = "STORAGE_USER_ID";

    function redirectToMain(){
        // 사용자 타입 저장
        // TODO: 한화에서 유저 타입 받으면 수정 필
        // 현재는 sales(영업사원), construction (시공사)
        var userType = $('#login_id').val().startsWith('s') ?  "sales" : "construction";
        M.data.storage(GLOBAL_USER_TYPE, userType);
        M.page.html("L_01_" + (userType === "sales" ? "08":"09") + ".html", {
            action: "CLEAR_TOP"
        });
    }
    
    /**
     * 비밀먼호 유효 검증 함수
     * 소문자, 숫자 조합이며 최소 8자리
     */
    // function checkPassword(pw) {
    // 	var re = /(?=.*\d)(?=.*[a-z]).{8,}/;
    // 	return re.test(pw);
    // }

    $(document).ready(function(){
        // 약관 선택
        var terms = $("input[name='rdo_chk01']");
        terms.change(function(){
            var termsChecked = $("input[name='rdo_chk01']:checked");

            if (terms.length === termsChecked.length){
                $("#btn_confirm").addClass("orange");
            } else {
                $("#btn_confirm").removeClass("orange");
            }
        });

        // 약관 동의
        $("#btn_confirm").off("click").on("click", function() {
            if ($(this).hasClass("orange")) {
                M.net.http.send({
                    server: 'TEST_SERVER',
                    path: 'lgi/updTosInfo',
                    method: 'POST',
                    timeout: 5000,
                    success: function(receivedData) {
                        //
                    },
                    error: function(errCode, errMsg) {
                        console.log("** onError", errCode, errMsg);
                    },
                    indicator: {
                        show : true,
                        message : '통신중입니다.',
                        cancelable : false
                    }
                });
                popupClose("#agreepopup");
                redirectToMain();
            } else {
                // Do nothing..
            }
        });

        // 저장한 아이디가 있으면 체크박스 켜기
        var login_id = M.data.storage(STORAGE_USER_ID);
        if (login_id) {
            $('#login_id').val(login_id);
            $('#chk_id_save').prop('checked', true);
        }

        // 로그인
        $('#btn_login').off('click').on('click', function(e) {
            // API 통신
            // TODO: 로그인 API
            M.net.http.send({
                server: "TEST_SERVER",
                path: "lgi/procLogin",
                method: "POST",
                timeout: 5000,
                data: {
                    userId: $('#login_id').val(),
                    userPw: $('#login_pw').val(),
                },
                success: function(receivedData) {
                    // console.log("** onSuccess", JSON.stringify(recevedData, null, 4), setting);
                    console.log(receivedData);
                    // 로그인 인증 실패
                    if (receivedData.retCode !== '0000') {
                        M.pop.alert({
                            title: '알림',
                            message: '아이디 혹은 비밀번호 오류입니다.\n\n아이디가 존재하지 않거나,\n아이디 또는 비밀번호를\n잘못 입력하셨습니다.',
                            buttons: ['확인'],
                        });
                        return;
                    }

                    // 아이디 저장
                    if ($('#chk_id_save').prop('checked')) {
                        M.data.storage(STORAGE_USER_ID, $('#login_id').val());
                    } else {
                        M.data.removeStorage(STORAGE_USER_ID);
                    }

                    // 약관동의 팝업
                    if (receivedData.priInfoYn !== 'Y' || receivedData.priPolYn !== 'Y' || receivedData.serPolYn !== 'Y') {
                        popupOpen("#agreepopup");
                    } else {
                        redirectToMain();
                    }
                },
                error: function(errCode, errMsg) {
                    console.log("** onError", errCode, errMsg);
                },
                indicator: {
                    show : true,
                    message : '통신중입니다.',
                    cancelable : false
                }
            });
        });
    });

    M.onReady(function(e) {
        // 고객센터 전화걸기
        $('#app_msg').off('click').on('click', function(e){
            M.sys.call($('#tel').text().replace('-', ''));
        });
    }).onHide(function(e){
        //hide event handle code here
    }).onRestore(function(e) {
        //restore event handle code here
    }).onResume(function(e) {
        //resume event handle code here
    }).onDestroy(function(e) {
        //destroy event handle code here
    }).onBack(function() {
        //back event handle code here
        // 종료하기
        // TODO: 지우기(기획에 없음)
        M.pop.alert("종료하시겠습니까?", {
            title: "종료",
            buttons: ["아니오", "예"],
            callback: function(index) {
                if(index === 1) {
                    M.sys.exit();
                }
            }
        });
    }).onKey(function(e) {
        //key event handle code here(android only)
    });
</script>
</body>
</html>
