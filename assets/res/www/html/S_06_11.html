<!DOCTYPE html>
<html lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width">
<title>한화 Home &amp; Q</title>
<link rel="stylesheet" type="text/css" href="../css/common.css">
<link rel="stylesheet" type="text/css" href="../css/content.css">
<link rel="stylesheet" type="text/css" href="../css/content2.css">
</head>
<body>

<!-- wrap -->
<div class="wrap">

    <!-- header -->
    <div class="header">
        <!-- <h1 class="page_title">실측</h1>
        <a href="#n" class="btn_home">home</a>
        <a href="#n" class="btn_gnb">전체메뉴</a> -->

        <!-- gnb -->
        <!-- <div class="gnb">
            <ul>
                <li class="green"><a href="#n">실측관리</a></li>
                <li class="green"><a href="#n">시공관리</a></li>
                <li class="setting"><a href="#n"><span>설정</span></a></li>
            </ul>
        </div> -->
        <!-- //gnb -->

        <!-- <a href="#n" class="page_prev">이전페이지</a> -->
    </div>

    <!-- //header -->

    <!-- content -->
    <div class="content survey">
        
        <div class="content_area">

            <!-- 본문내용 -->
            
            <div class="accept_wrap">
                <strong class="date">2018-08-31</strong>
                <a href="#n" class="btn middle orange" data-event-page="S_06_13.html">신규예약접수</a>
            </div>
            
            <div class="section">
                
                <!-- srch_wrap -->
                <div class="srch_wrap">
                    <a href="#n" class="btn_srch_open">검색</a>
                    <div class="srch_area">
                        <ul>
                            <li>
                                <strong class="tit">실측(예정)일</strong>
                                <div class="webkit_box">
                                    <span class="box_flex1">
                                        <input type="date" value="" id="searTermFr" data-mdate><!-- 날짜 -->
                                    </span>
                                    <span class="box_flex0 dash">
                                        ~
                                    </span>
                                    <span class="box_flex1">
                                        <input type="date" value="" id="searTermTo" data-mdate><!-- 날짜 -->
                                    </span>
                                </div>
                            </li>
                            <li>
                                <strong class="tit">현재진행상태</strong>
                                <div class="webkit_box">
                                    <span class="box_flex1">
                                        <select id="searCnstwStCd">
                                            <option value="0">전체</option>
                                            <option value="1">실측예약</option>
                                            <option value="2">실측확정</option>
                                            <option value="3">실특완료</option>
                                        </select>
                                    </span>
                                </div>
                            </li>
                        </ul>
                        <span class="btn_srch"><a href="#n" class="btn middle gray" id="search">검색</a></span>
                        <div class="srch_control">
                            <a href="#n" class="btn_reset">초기화</a>
                            <a href="#n" class="btn_cls"><span>닫기</span></a>
                        </div>
                    </div>
                </div>
                <!-- //srch_wrap -->

                <div class="list_num">
                    <span><em>12</em>건 / 총 <em>12</em>건</span>
                </div>
                <!-- TODO : 20181025 li a영역 수정 -->
                <ul class="survey_list">
                    <li>
                        <div class="division type02">
                            <span class="left_txt"><span class="split_w">창호</span><span>현대인테리어</span></span>
                            <span class="rignt_txt">실측접수</span>
                        </div>
                        <div class="mid">
                            <span class="date">2018-08-31 (09:00~10:00)</span>
                            <span class="num">[TI20160523000000] 비거주(개보수)</span>
                            <span class="addr">서울 중구 을지로5길 26 센터원 좋은아파트 11동 1004호</span>
                            <a href="#" class="go_list" data-event-page="S_06_21.html"></a>
                        </div>
                        <div class="bot">
                            <span class="company">서울 창호 시스템</span>
                            <span class="charge">김프로(01012344321)</span>
                        </div>
                    </li>
                    <li>
                        <div class="division type02">
                            <span class="left_txt"><span class="split_w">창호</span><span>현대인테리어</span></span>
                            <span class="rignt_txt">실측접수</span>
                        </div>
                        <div class="mid">
                            <span class="date">2018-08-31 (09:00~10:00)</span>
                            <span class="num">[TI20160523000000] 비거주(개보수)</span>
                            <span class="addr">서울 중구 을지로5길 26 센터원 좋은아파트 11동 1004호</span>
                            <a href="" class="go_list"></a>
                        </div>
                        <div class="bot">
                            <span class="company">서울 창호 시스템</span>
                            <span class="charge">김프로(01012344321)</span>
                        </div>
                    </li>
                    <li>
                        <div class="division type02">
                            <span class="left_txt"><span class="split_w">창호</span><span>현대인테리어</span></span>
                            <span class="rignt_txt">실측접수</span>
                        </div>
                        <div class="mid">
                            <span class="date">2018-08-31 (09:00~10:00)</span>
                            <span class="num">[TI20160523000000] 비거주(개보수)</span>
                            <span class="addr">서울 중구 을지로5길 26 센터원 좋은아파트 11동 1004호</span>
                            <a href="" class="go_list"></a>
                        </div>
                        <div class="bot">
                            <span class="company">서울 창호 시스템</span>
                            <span class="charge">김프로(01012344321)</span>
                        </div>
                    </li>
                </ul>
                <!--// TODO : 20181025 a영역 수정 -->
                <div class="tac mt20">
                    <a href="#n" class="btn large basic" id="addList"><span class="add">더보기</span></a>
                </div>
            </div>

            <hr>
            <!-- 본문내용 -->
        </div>
    </div>
    <!-- //content -->

</div>
<!-- //wrap -->
<script type="text/javascript" src="../js/mcore.min.js"></script>
<script type="text/javascript" src="../js/header.js"></script>
<script type="text/javascript" src="../js/moment.min.js"></script>
<script type=“text/javascript” src="../js/locales.min.js"></script>
<script type="text/javascript" src="../js/module.js"></script>
<!-- // -->
<script type="text/javascript">
    "use strict";
    //TODO: 개발 미비
    
    //페이지 이동시 전달할 데이터
    var pageData = {};

    $(document).ready(function(){
        $(".header").header({
            type:"construction",
            title:"실측",
            headerType:"menu",
            callback:function(){
                pageNav(pageData);
            }
        });

        //날짜 데이터 피커 공통 모듈
        $("[data-mdate]").mDate();
        // 상단 날짜 표시
        $(".accept_wrap .date").text(moment().format("YYYY-MM-DD"));

        // 검색 초기화
        $(".srch_control .btn_reset").off("click").on("click", function() {
            $(".srch_area li input").val("");
            $(".srch_area li select").val("전체");
        });

        //더보기 버튼 클릭시 이벤트 등록
        $("#addList").off("click").on("click",function(){
            $("#search").trigger("click");
        });

        // TODO: 실측 리스트 검색조건 조회 API 연동
        httpSend({
            path: 'svy/lst/inquireSvrStdList',
            successCallback: function(recevedData) {
                console.log("svy/lst/inquireSvrStdList",recevedData);
                $("#searCnstwStCd").children().remove();
                recevedData.retList.map(function(v){
                    console.log("list:",v);
                    $("#searCnstwStCd").append("<option value='"+v.commonLineCode+"'>"+v.commonLineName+"</option>");
                })
            }
        });

        //검색 API
        $("#search").off("click").on("click",function(){
            httpSend({
                path: 'svy/lst/inquireSvrList',
                data:{
                    // searTermFr : $("#searTermFr").val(),
                    // searTermTo : $("#searTermTo").val(),
                    searCnstwStCd : $("#searCnstwStCd").val(),
                },
                successCallback: function(recevedData) {
                    console.log("svy/lst/inquireSvrList :: search",recevedData);
                    listMake(recevedData.retList);

                    //페이지 이동 다시 이벤트 등록 
                    pageNav();

                    //더보기 버튼 현재 페이지와 최종 페이지가 같으면 더보기 버튼 사라짐 
                    (recevedData.cnt == recevedData.totCnt)? $("#addList").hide() : $("#addList").show(); 
                }
            });
        });

        //랜더링
        //검색 결과 리스트로 생성하는 함수
        function listMake(param){
            // param = [{
            //     "cnstwStName": "예약",
            //     "jobsTypeCd1": "10",
            //     "jobsTypeCd2": "10",
            //     "muCode": "2",
            //     "muName": "창호",
            //     "vndorName": "GB금보인테리어",
            //     "vndorCode": 10602,
            //     "cnstwOrdNo": "S01-20181018-R011",
            //     "cnstwFirmCd": 24595,
            //     "RNUM": 1,
            //     "cnstwFirmNm": "(사)한국경제연구원",
            //     "jobsTypeName1": "신축",
            //     "cnstwRsrtTim": "18:00",
            //     "jobsTypeName2": "거주",
            //     "addrDetail": "센터원빌딩 7_8층",
            //     "addr": "서울특별시 중구 을지로5길 26",
            //     "cnstwRsrtDt": "20181120"
            // }];

            //태그 생성 
            //TODO : 미구현 목록 
            /*
            */
            function makeTag(data){
                return $('<li>\
                        <div class="division type02">\
                            <span class="left_txt"><span class="split_w">'+data.muName+'</span><span>'+data.vndorName+'</span></span>\
                            <span class="rignt_txt">'+data.cnstwStName+'</span>\
                        </div>\
                        <div class="mid">\
                            <span class="date">'+moment(data.cnstwRsrtDt).format("YYYY-MM-DD")+'('+data.cnstwRsrtTim+')</span>\
                            <span class="num">['+data.cnstwOrdNo+'] '+data.jobsTypeName2+'('+data.jobsTypeName1+')</span>\
                            <span class="addr">'+data.addr+''+data.addrDetail+'</span>\
                            <a href="#" class="go_list" data-event-page="S_06_21.html"></a>\
                        </div>\
                        <div class="bot">\
                            <span class="company">'+data.cnstwFirmNm+'</span>\
                            <span class="charge">'+data.cnstwHpwNm+'('+data.ccpc+')</span>\
                        </div>\
                    </li>');
            };
            
            //태그 랜더링 
            $(".survey_list").children().remove();
            $(param).each(function(index,el){
                console.log(el);
                $(".survey_list").append(makeTag(el));
            });
        }
    });
    
    M.onReady(function(e) {
        //ready event handle code here
        console.log("onReady");
    }).onHide(function(e){
        //hide event handle code here
        console.log("onHide");
    }).onRestore(function(e) {
        //restore event handle code here
        console.log("onRestore");
    }).onResume(function(e) {
        //resume event handle code here
        console.log("onResume");
    }).onDestroy(function(e) {
        //destroy event handle code here
        console.log("onDestroy");
    }).onBack(function() {
        //back event handle code here
        console.log("onBack");
        M.page.back();
    }).onKey(function(e) {
        //key event handle code here(android only)
        console.log("onKey");
    });
</script>
<script type="text/javascript" src="../js/common.js"></script>
</body>
</html>
