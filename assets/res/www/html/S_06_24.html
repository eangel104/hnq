<!DOCTYPE html>
<html lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width">
<title>한화 Home &amp; Q</title>
<link rel="stylesheet" type="text/css" href="../css/common.css">
<link rel="stylesheet" type="text/css" href="../css/content.css">
<link rel="stylesheet" type="text/css" href="../css/content2.css">
</head>
<body>

<!-- wrap -->
<div class="wrap">

	<!-- header -->
	<div class="header">
		<!-- <h1 class="page_title">실측완료</h1>
		<a href="#n" class="page_prev">이전페이지</a> -->
	</div>

	<!-- //header -->

	<!-- content -->
	<div class="content survey_comp">
		<div class="content_area">
			<ul class="tabmenu02" id="tab1">
				<li class="on"><a href="#tab1-1"><span>실측지 정보</span></a></li><!-- 활성화 class = "on" -->
				<li><a href="#tab1-2"><span>고객확인</span></a></li>
			</ul>

			<div class="tab_panel" id="tab_cont1">
				<div id="tab1-1" class="panel">
					<!-- 본문내용 -->
					<div class="section">
						<div class="tit_btn">
							<h3 class="tit_type01">실측지사진</h3>
							<a href="#n" class="btn middle orange">사진 불러오기</a>
						</div>
						<div>
							<ul class="image_list" data-max-images="4">
								<li>
									<a href="#n">
										<img src="../img/content/test_img.gif" alt="테스트이미지">
									</a>
									<a href="#n" class="btn_delete">삭제</a>
								</li>
								<li>
									<a href="#n">
										<img src="../img/content/test_img.gif" alt="테스트이미지">
									</a>
									<a href="#n" class="btn_delete">삭제</a>
								</li>
								<li>
									<a href="#n">
										<img src="../img/content/test_img.gif" alt="테스트이미지">
									</a>
									<a href="#n" class="btn_delete">삭제</a>
								</li>
								<li>
									<a href="#n">
										<img src="../img/content/test_img.gif" alt="테스트이미지">
									</a>
									<a href="#n" class="btn_delete">삭제</a>
								</li>
							</ul>
						</div>
						<div class="tit_btn">
							<h3 class="tit_type01">현장 정보 사진</h3>
							<a href="#n" class="btn middle orange">사진 불러오기</a>
						</div>
						<div>
							<ul class="image_list" data-max-images="8">
								<li>
									<a href="#n">
										<img src="../img/content/test_img.gif" alt="테스트이미지">
									</a>
									<a href="#n" class="btn_delete">삭제</a>
								</li>
								<li>
									<a href="#n">
										<img src="../img/content/test_img.gif" alt="테스트이미지">
									</a>
									<a href="#n" class="btn_delete">삭제</a>
								</li>
								<li>
									<a href="#n">
										<img src="../img/content/test_img.gif" alt="테스트이미지">
									</a>
									<a href="#n" class="btn_delete">삭제</a>
								</li>
								<li>
									<a href="#n">
										<img src="../img/content/test_img.gif" alt="테스트이미지">
									</a>
									<a href="#n" class="btn_delete">삭제</a>
								</li>
							</ul>
						</div>
					</div>
					<!-- 본문내용 -->
				</div>
				<div id="tab1-2" class="panel">
					<!-- 본문내용 -->
					<div class="section">
						<div class="tac">
							<a href="#n" class="btn middle orange">고객확인</a>
						</div>
						<div class="sign_box mt20"></div> <!-- 싸인영역 -->
					</div>
					<!-- 본문내용 -->
				</div>
			</div>

			<!-- <script type="text/javascript">
				$('#tab1').fnTab();
			</script> -->
		</div>
		<div class="btn_fix">
			<a href="#n" class="btn gray" id="btn_cancel">취소</a>
			<a href="#n" class="btn green" id="btn_save">저장</a>
		</div>
	</div>
	<!-- //content -->

</div>
<!-- //wrap -->
<script type="text/javascript" src="../js/mcore.min.js"></script>
<script type="text/javascript" src="../js/header.js"></script>
<script type="text/javascript" src="../js/module.js"></script>
<!-- // -->
<script type="text/javascript">
    "use strict";
	//TODO: 개발 미비
	
    $(document).ready(function(){
        $(".header").header({
            type:"construction",
            title:"실측완료",
            callback:function(){
                pageNav();
            }
		});
		
		$('#tab1').fnTab();

		var btnLoadImages = $("#tab1-1 .btn.middle.orange");
		var btnCheckCustomer = $("#tab1-2 .btn.middle.orange");

		// 사진 불러오기
		$(btnLoadImages).off("click").on("click", function(){
			var imageList = $(this).parent().next().children("ul");
			var maxCount = parseInt(imageList.attr("data-max-images"));
			var images = $(imageList).find("img");

			// 카메라, 앨범 선택 팝업
			M.pop.list({
				mode: "SINGLE",
				title: "프로필 사진",
				button: [],	// `취소` 버튼이 무조건 생성됨..
				list: [
					{ title: "카메라", value: "camera" },
					{ title: "갤러리", value: "album" }
				],
				callback: function(buttonIdx, rowInfo, setting) {
					var non_images = $(images).filter("[src='../img/content/test_img.gif']");
					if(non_images.length < 1) {
						M.pop.alert("사진을 더 이상 첨부 할 수 없습니다.");
						return;
					}

					// 카메라
					if(rowInfo.value === "camera") {
						M.media.camera({
							path: "/media",
							mediaType: "PHOTO",
							saveAlbum: false,
							callback: function(status, result) {
								if (status == 'SUCCESS') {
									$(non_images[0]).attr("src", result.path);
								} else {
									// Error handling here..
								}
							}
						});
					} 
					// 앨범
					else if(rowInfo.value === "album") {
						M.media.picker({
							mode: "MULTI",
							media: "PHOTO",
							// path: "/media",
							maxCount: non_images.length,
							column: 4,
							detail: true,
							callback: function(status, result) {
								if(status === "SUCCESS") {
									// 사진 등록
									result.map(function(photo, index) {
										$(non_images[index]).attr("src", photo.path);
									});
								} else {
									// Error handling here..
								}
							}
						});
					}
				}
			});
		});
		
		// 이미지 클릭 시 원본 크기로 보여주기
		$("#tab1-1 li img").off("click").on("click", function() {
			// TODO
			console.log(this);
		});
		
		// 등록한 사진 삭제
		$(".btn_delete").off("click").on("click", function() {
			$(this).siblings().children("img").attr("src", "../img/content/test_img.gif");
		});

		// 저장하기
		$("#btn_save").off("click").on("click", function() {
			console.log("save");
		});
		// 취소
		$("#btn_cancel").off("click").on("click", function() {
			console.log("back");
			M.page.back();
		});
	});
	
    M.onReady(function(e) {
        
    }).onHide(function(e){
        //hide event handle code here
        console.log("onHide");
    }).onRestore(function(e) {
        //restore event handle code here
		console.log("onRestore");
    }).onResume(function(e) {
        //resume event handle code here
        console.log("onResume");
    }).onDestroy(function(e) {
        //destroy event handle code here
        console.log("onDestroy");
    }).onBack(function() {
        //back event handle code here
        console.log("onBack");
        M.page.back();
    }).onKey(function(e) {
        //key event handle code here(android only)
        console.log("onKey");
    });
</script>
<script type="text/javascript" src="../js/common.js"></script>
</body>
</html>
